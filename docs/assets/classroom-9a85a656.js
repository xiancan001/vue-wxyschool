import{a8 as r,_ as F,d as I,o as c,c as g,a as h,b as s,w as a,F as p,e as d,S as V,C as _}from"./index-ae53bb55.js";import{E as $}from"./el-overlay-3b85e2f1.js";import{E as D,a as v,b as z}from"./el-input-7b5180f0.js";import{E as t,a as A,b as B}from"./el-table-column-95c8a42d.js";import{E as q,a as S}from"./el-select-f4ca1eaa.js";import{E as U}from"./el-button-034252dd.js";import{c as N}from"./cloneDeep-3d5bcdf8.js";import"./validator-72ca27f5.js";const L=e=>r.request({url:"api/classroom/add",method:"post",data:e}),P=()=>r.request({url:"api/classroom/all",method:"get"}),O=e=>r.request({url:"api/classroom/delete",method:"get",params:e}),W=e=>r.request({url:"api/classroom/edit",method:"post",data:e}),T=e=>r.request({url:"api/classroom/one",method:"get",params:{id:e}}),M=()=>r.request({url:"api/building/all",method:"get"}),j=()=>r.request({url:"api/school/all",method:"get"}),G=I({data(){return{classrooms:[],page:{total:0,current:1,size:5},dialogFormVisible:!1,classroom:{building:"",id:null,name:"",school:""},formLabelWidth:80,searchId:"",buildings:[],schools:[]}},mounted(){this.getClassroomsPage(1),this.getAllBuildingData(),this.getAllSchoolData()},methods:{toEdit(e){console.log(e),this.dialogFormVisible=!0,this.classroom=N(e)},getClassroomsPage(e){this.page.size,P().then(l=>{console.log(l),l.success?(this.classrooms=l.data.classrooms,this.page={total:l.data.classrooms.length,current:l.data.current,size:l.data.size}):console.log(l.msg)}).catch(l=>{console.log(l)})},del(e){console.log(e),O({id:e}).then(i=>{if(i.success)this.getClassroomsPage(this.page.current);else return console.log(i.msg),!1}).catch(i=>{})},addOrUpdateClassroom(){const e=this.classroom;e.id?W(e).then(l=>{l.success?(this.dialogFormVisible=!1,this.getClassroomsPage(this.page.current),t.success(l.msg)):t.error(l.msg)}).catch(l=>{t.error("网络错误，请联系管理员")}):L(e).then(l=>{l.success?(this.dialogFormVisible=!1,this.getClassroomsPage(this.page.current),t.success(l.msg)):t.error(l.msg)}).catch(l=>{t.error("网络错误，请联系管理员")})},toAdd(){this.dialogFormVisible=!0,this.classroom={building:"",id:null,name:"",school:""}},searchClassroom(){const e=parseInt(this.searchId);if(isNaN(e)){t.warning("请输入有效的教室ID");return}console.log("Searching classroom with ID:",e),T(e).then(l=>{if(console.log("Search result:",l),l.success){const i=l.data.classinfo;this.classrooms=[i],this.page={total:1,current:1,size:this.page.size}}else t.error(l.msg)}).catch(l=>{t.error("网络错误，请联系管理员")})},getAllBuildingData(){M().then(e=>{console.log(e),e.success?this.buildings=e.data.buildings:console.log(e.msg)}).catch(e=>{console.log(e)})},getAllSchoolData(){j().then(e=>{console.log(e),e.success?this.schools=e.data.schools:console.log(e.msg)}).catch(e=>{console.log(e)})}}}),H={class:"classrooms"},J={class:"classroom-tools"},K={class:"dialog-footer"};function Q(e,l,i,R,X,Y){const n=U,f=D,m=B,w=A,u=v,b=q,C=S,k=z,E=$;return c(),g(p,null,[h("div",H,[h("div",J,[s(n,{type:"warning",onClick:e.toAdd},{default:a(()=>[d("添加")]),_:1},8,["onClick"]),s(f,{modelValue:e.searchId,"onUpdate:modelValue":l[0]||(l[0]=o=>e.searchId=o),placeholder:"请输入教室ID",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),s(n,{type:"primary",onClick:e.searchClassroom},{default:a(()=>[d("搜索")]),_:1},8,["onClick"])]),s(w,{data:e.classrooms,style:{width:"100%"}},{default:a(()=>[s(m,{fixed:"",prop:"id",label:"ID",width:"150"}),s(m,{prop:"name",label:"教室名称",width:"120"}),s(m,{prop:"building",label:"所在建筑",width:"120"}),s(m,{prop:"school",label:"所属学校",width:"120"}),s(m,{fixed:"right",label:"功能管理",width:"120"},{default:a(o=>[s(n,{link:"",type:"primary",size:"small",onClick:y=>e.toEdit(o.row)},{default:a(()=>[d("更新")]),_:2},1032,["onClick"]),s(n,{link:"",type:"primary",size:"small",onClick:y=>e.del(o.row.id)},{default:a(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),s(E,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[5]||(l[5]=o=>e.dialogFormVisible=o),title:"教室编辑"},{footer:a(()=>[h("span",K,[s(n,{onClick:l[4]||(l[4]=o=>e.dialogFormVisible=!1)},{default:a(()=>[d("Cancel")]),_:1}),s(n,{type:"primary",onClick:e.addOrUpdateClassroom},{default:a(()=>[d("保存")]),_:1},8,["onClick"])])]),default:a(()=>[s(k,{model:e.classroom},{default:a(()=>[s(u,{label:"教室名称","label-width":e.formLabelWidth},{default:a(()=>[s(f,{modelValue:e.classroom.name,"onUpdate:modelValue":l[1]||(l[1]=o=>e.classroom.name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),s(u,{label:"所在建筑","label-width":e.formLabelWidth},{default:a(()=>[s(C,{modelValue:e.classroom.building,"onUpdate:modelValue":l[2]||(l[2]=o=>e.classroom.building=o),placeholder:"请选择所在建筑"},{default:a(()=>[(c(!0),g(p,null,V(e.buildings,o=>(c(),_(b,{key:o.id,label:`${o.id}（${o.name}）`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),s(u,{label:"所属学校","label-width":e.formLabelWidth},{default:a(()=>[s(C,{modelValue:e.classroom.school,"onUpdate:modelValue":l[3]||(l[3]=o=>e.classroom.school=o),placeholder:"请选择所属学校"},{default:a(()=>[(c(!0),g(p,null,V(e.schools,o=>(c(),_(b,{key:o.id,label:`${o.id}（${o.schoolName}）`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const re=F(G,[["render",Q]]);export{re as default};
