import{_ as E,d as P,o as n,c as g,a as u,a3 as v,b as a,w as i,F as f,S as b,C as m,e as c}from"./index-ae53bb55.js";import{E as j}from"./el-overlay-3b85e2f1.js";import{E as k,a as O,b as q}from"./el-input-7b5180f0.js";import{E as S}from"./el-pagination-0a0b544d.js";import{E as r,b as $,a as M}from"./el-table-column-95c8a42d.js";import"./el-select-f4ca1eaa.js";import{E as N}from"./el-popover-da40d4ae.js";import{E as A}from"./el-button-034252dd.js";/* empty css                   */import{c as d}from"./cloneDeep-3d5bcdf8.js";const R=P({props:{mainTitle:{type:String,required:!0},muncObj:{type:Array,required:!0},userido:{type:String,default:"4",required:!0}},data(){return{MainTitle:this.mainTitle,FuncObj:this.muncObj,pageSize:[3,5,7,10,20,30],dat:{},topics:[],resultData:{},requestData:{userId:this.userido},topic:{},choseRow:{},dialogFormVisible:!1,formLabelWidth:70,dialogVisible:!1,wantAdd:!0,rules:{}}},mounted(){this.getTopicPage()},methods:{btnLink(){console.log("<---------------->",this.topic),console.log(this.topics),console.log()},getTopicPage(){this.FuncObj[3](this.requestData).then(e=>{console.log("-------page-拿到的数据--------",e),e.success?(this.topics=Object.values(e.data)[0],this.resultData=e.data,this.topic=d(this.topics[0]),console.log(this.topic),this.setObjPropsToNull(this.topic)):(r({message:"没有相关数据！！!",type:"warning"}),this.topics=[],this.topic={nodata:"NoData"})}).catch(e=>{console.log(e)})},handleSizeChange(e){this.requestData.size=e,this.getTopicPage()},handleCurrentChange(e){this.requestData.current=e,this.getTopicPage()},showDialog(e,t){this.wantAdd=e,this.dat=d(t),console.log("xxxxx"),e?this.setObjPropsToNull(this.topic):(this.topic=d(t),console.log(t)),this.dialogFormVisible=!0},del(e){const t={id:e};this.FuncObj[1](t).then(l=>{l.success?(console.log("--删除成功--"),this.getTopicPage(e),e%2!=0?this.getTopicPage(this.requestData.current-1):(console.log("--删除成功!--"),this.getTopicPage(this.requestData.current)),r({message:"数据删除成功!",type:"success"})):r({message:"删除警告,数据删除失败!",type:"warning"})}).catch(l=>{console.log("访问错误",l),r.error("删除错误，代码可能有错！"+l)})},async save(){await this.$refs.dialogFormRef.validate((e,t)=>{e?(console.log("submit!"),this.wantAdd?this.FuncObj[0](this.topic).then(l=>{r({message:"数据添加成功!",type:"success"}),this.requestData.current=Math.ceil((this.resultData.total+1)/this.resultData.size),this.getTopicPage()}).catch(l=>{r.error("添加错误，网络接口出错！")}):this.FuncObj[2](this.topic).then(l=>{l.success?(r({message:"数据修改成功!",type:"success"}),this.getTopicPage()):r({message:"数据修改失败!",type:"warning"})}).catch(l=>{r.error("修改错误，网络接口出错！")}),this.dialogFormVisible=!1):console.log("error submit!",t)})},resetForm(){console.log(this.$refs.dialogFormRef),this.$refs.dialogFormRef.resetFields(),this.wantAdd?this.topic=d(this.topic):this.topic=d(this.dat)},setObjPropsToNull(e){Object.keys(e).forEach(t=>{e[t]=null})}},watch:{mainTitle:{handler(e,t){this.MainTitle=e}},muncObj:{deep:!0,handler(e,t){this.FuncObj=e,this.getTopicPage()}},userido:{handler(e,t){console.log("---userido----"),this.requestData.userId=e,this.getTopicPage()}}}}),B={class:"tools"},I={style:{"margin-top":"10px","margin-left":"30%"}},U={class:"dialog-footer"};function L(e,t,l,W,G,H){const h=$,p=A,_=N,y=M,C=S,T=k,D=O,F=q,w=j;return n(),g("div",null,[u("div",B,[u("p",null,v(e.MainTitle)+"管理",1)]),u("div",null,[a(y,{"max-height":"600",data:e.topics,style:{width:"100%"}},{default:i(()=>[(n(!0),g(f,null,b(e.topic,(o,s)=>(n(),m(h,{prop:s,label:s,key:s.id,formatter:e.getCategoryNameFormat},null,8,["prop","label","formatter"]))),128)),a(h,{fixed:"right",label:"功能管理",width:"170"},{default:i(o=>[a(p,{size:"small",onClick:s=>e.showDialog(!1,o.row)},{default:i(()=>[c("编辑")]),_:2},1032,["onClick"]),a(_,{title:"删除将无法恢复！确定删除?",onConfirm:s=>e.del(o.row.id)},{reference:i(()=>[a(p,{size:"small",type:"danger"},{default:i(()=>[c("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),a(p,{icon:"Plus",style:{width:"100%","background-color":"#e3f7d8"},onClick:t[0]||(t[0]=o=>e.showDialog(!0))}),u("div",I,[a(C,{"current-page":e.resultData.current,"onUpdate:currentPage":t[1]||(t[1]=o=>e.resultData.current=o),"page-size":e.resultData.size,"onUpdate:pageSize":t[2]||(t[2]=o=>e.resultData.size=o),small:e.small,disabled:e.disabled,background:e.background,"page-sizes":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.resultData.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","small","disabled","background","page-sizes","total","onSizeChange","onCurrentChange"])]),a(w,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[4]||(t[4]=o=>e.dialogFormVisible=o),title:e.wantAdd?e.MainTitle+"添加":e.MainTitle+"修改"},{footer:i(()=>[u("span",U,[a(p,{onClick:t[3]||(t[3]=o=>e.resetForm())},{default:i(()=>[c("重置")]),_:1}),a(p,{type:"primary",onClick:e.save},{default:i(()=>[c(" 保存 ")]),_:1},8,["onClick"])])]),default:i(()=>[a(F,{ref:"dialogFormRef",model:e.topic,rules:e.rules},{default:i(()=>[(n(!0),g(f,null,b(e.topic,(o,s,V)=>(n(),m(D,{label:s,prop:s,key:V,"label-width":e.formLabelWidth},{default:i(()=>[(n(),m(T,{modelValue:e.topic[s],"onUpdate:modelValue":z=>e.topic[s]=z,autocomplete:"off",clearable:"",key:s},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label","prop","label-width"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}const se=E(R,[["render",L],["__scopeId","data-v-c6ee636c"]]);export{se as _};
